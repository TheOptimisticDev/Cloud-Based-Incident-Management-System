<div class="text-center" data-ng-if="item.error">Error: <span data-ng-bind="item.error"></span> <button type="button" class="btn btn-default" data-ng-click="resendPost(item)" data-ng-disabled="post.isResending">Resend</button></div>
<div class="row">
    <div class="qa-review-top-separator col-sm-11 col-sm-offset-1" data-ng-if="item.reviewEndPoint"></div>
    <div class="qa-review-bottom-separator col-sm-11 col-sm-offset-1" data-ng-if="item.noConversationWithinTicket"></div>
    <div class="col-sm-2 text-center">
        <ng-switch data-on="item.isOurSide">
            <div data-ng-switch-when="true">
                <i data-ng-if="item.isAutomatic" class="fa fa-magic" title="This is an automatic message"></i>
                <strong data-ng-if="!inQaMode" data-ng-bind="item.senderTitle"></strong>
                <strong data-ng-if="inQaMode"> Receptionist </strong>
                <div data-ng-if="!item.sentAt || !item.status"><small><i data-am-time-ago="item.createdAt" title="{{item.createdAt|date:'short'}}"></i></small></div>
                <div data-ng-switch="item.status">
                    <small data-ng-switch-when="completed"><i data-am-time-ago="item.sentAt" title="{{item.sentAt|date:'short'}}"></i></small>
                    <small data-ng-switch-when="pending">
                        <span data-ng-if="item.shouldBeSendAt">Will be send at: <span data-ng-bind="item.shouldBeSendAt|date:'short'"></span></span>
                        <span data-ng-if="!item.shouldBeSendAt"><img src="/app/core/img/loaders/loader.gif" alt="Loading"></span>
                    </small>
                    <small data-ng-switch-when="error" class="label label-danger">Error</small>
                </div>
                <div data-ng-if="item.postId && isAllowedToReportMistake" class="thread-post-mistake">
                    <span data-ng-if="item.reportedAsMistakeAt" class="label label-danger"><i class="fa fa-exclamation-circle"></i></span>

                    <div class="btn-group" data-uib-dropdown data-ng-if="!item.reportedAsMistakeAt">
                        <button class="btn btn-danger btn-xs dropdown-toggle" type="button" uib-dropdown-toggle title="Report as mistake" data-ng-disabled="post.isReporting"><i class="fa fa-exclamation-circle"></i>Report as Mistake</button>
                        <ul class="dropdown-menu" role="menu" uib-dropdown-menu>
                            <li data-ng-repeat="reason in mistakesReasons"><a class="btn" data-ng-click="reportMistake(item, reason)" data-ng-bind="reason"></a></li>
                        </ul>
                    </div>
                    <span data-ng-if="!item.reportedAsMistakeAt"></span>
                </div>
            </div>
            <div data-ng-switch-default><i class="pull-right module-icon {{messageMethods[item.module].classAttr}}"></i></div>
        </ng-switch>
    </div>
    <div class="panel panel-default col-sm-8" data-ng-class="'module-'+item.module + (item.status === 'error' ? ' bg-danger': '') + (item.senderTitle === 'User' ? ' bg-dark-blue' : '') + ((item.isOurSide && !item.isAutomatic && item.senderTitle !== 'User') ? ' bg-light-blue' : '') + (item.isOurSide && item.isAutomatic ? ' bg-purple' : '')">
        <div class="panel-body" ng-class="{'thread-under-qa-review' : item.isInReview}">
            <div class="help-block text-right">
                <span data-ng-if="item.from"><strong>FROM:</strong> {{item.from}}</span>
                <span data-ng-if="item.to"><strong>To:</strong> {{item.to}}</span>
                <span data-ng-if="item.cc"><strong>CC:</strong> {{item.cc.join(', ')}}</span>
                <span data-ng-if="item.bcc"><strong>BCC:</strong> {{item.bcc.join(', ')}}</span>
            </div>
            <div class="free-content" data-ng-bind-html="item.body | trustedHtml | clearStyleBodyTags"></div>
        </div>
    </div>

    <div class="col-sm-2 text-center">
        <ng-switch on="item.isOurSide">
            <div data-ng-switch-when="false">
                <strong data-ng-bind="item.senderTitle"></strong>
                <div><small><i data-am-time-ago="item.createdAt" title="{{item.createdAt|date:'short'}}"></i></small></div>
                <ng-switch on="item.feedback.value">
                    <i data-ng-switch-when="good" class="text-success fa fa-thumbs-o-up feedback-status" title="Good feedback"></i>
                    <i data-ng-switch-when="bad" class="text-danger fa fa-thumbs-o-down feedback-status" title="Bad feedback"></i>
                    <i data-ng-switch-when="cleaning" class="text-muted fa fa-home feedback-status" title="Cleaning issue"></i>
                    <div data-ng-switch-default class="btn-group display-hover">
                        <button type="button" title="Good feedback" class="btn btn-default text-center btn-xs" data-ng-click="setPostFeedback(item, 'good')" data-ng-disabled="disableFeedbackButtons"><i class="fa fa-thumbs-o-up text-success"></i></button>
                        <button type="button" title="Bad feedback" class="btn btn-default text-center btn-xs" data-ng-click="setPostFeedback(item, 'bad')" data-ng-disabled="disableFeedbackButtons"><i class="fa fa-thumbs-o-down text-danger"></i></button>
                        <button type="button" title="Cleaning issue" class="btn btn-default text-center btn-xs" data-ng-click="setPostFeedback(item, 'cleaning')" data-ng-disabled="disableFeedbackButtons"><i class="fa fa-home"></i></button>
                    </div>
                </ng-switch>
            </div>
            <div data-ng-switch-default><i class="pull-left module-icon {{messageMethods[item.module].classAttr}}"></i></div>
        </ng-switch>
    </div>
    <div class="qa-review-bottom-separator col-sm-11 col-sm-offset-1" data-ng-if="item.reviewStartPoint"></div>

</div>
