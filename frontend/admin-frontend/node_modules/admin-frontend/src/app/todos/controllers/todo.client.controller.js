'use strict';

angular.module('todos').controller('TodoController', [
    '$scope',
    'Todos',
    'Listing',
    'Translate',
    'gNotify',
	function($scope, Todos, Listing, Translate, gNotify) {
        $scope.todo = Todos.get({todoId: $scope.todoId}, function(){
            if ($scope.todo.isIncomingReview && $scope.todo.listingId){
                Listing.get({listingId: $scope.todo.listingId, fields:'receptionistsService.reviews.monitorIncomingReviewsGuidelines'}, function(listing){
                    $scope.reviewGuidelines = _.get(listing, 'receptionistsService.reviews.monitorIncomingReviewsGuidelines');
                });
            }
        });

        /**
         * send all thread to google-translate and replace with current thread.
         */
        $scope.translateTodo= function () {
            Translate.translateText([$scope.todo], 'body').then(function (googleTranslateResults) {
                $scope.todo.body = googleTranslateResults[0];
                $scope.hideTranslateButton = true;
            }, function () {
                gNotify.alert('Could not translate the text');
            });
        };
	}
]);
