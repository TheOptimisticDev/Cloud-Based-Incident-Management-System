'use strict';


angular.module('reservations').directive('reservationPopup', function reservationPopup() {
    return {
        restrict: 'A',
        scope: {
            reservationId: '@reservationPopup'
        },
        template: '<div uib-tooltip-template="\'app/reservations/views/calendar.reservation.popup.html\'" tooltip-append-to-body="true" tooltip-popup-delay="500" tooltip-class="reservation-popup" ng-transclude></div>',
        transclude: true
    };
}).controller('CalendarReservationPopupCtrl', [
    '$scope',
    'Reservations',
    function($scope, Reservation) {
        $scope.reservation = Reservation.getApi2({
            reservationId: $scope.reservationId,
            fields: 'status checkIn checkOut nightsCount guestsCount money.hostPayout money.currency guest.fullName guest.pictures.thumbnail plannedArrival plannedDeparture'},
            function(reservation){

                if (reservation.status==='confirmed')
                    $scope.reservationCssClass = 'label-success';
                else if (reservation.status === 'reserved')
                    $scope.reservationCssClass = 'label-warning';
                else if (reservation.status === 'canceled')
                    $scope.reservationCssClass = 'label-danger';
                else $scope.reservationCssClass = 'label-default';

            }
        );
    }
]);