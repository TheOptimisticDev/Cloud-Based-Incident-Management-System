'use strict';

// Reservations controller
angular.module('reservations').controller('ReservationLogBoxController', ['$scope', 'Reservations',
    function($scope, Reservations) {

        var limitIfNecessary = function(logs){
            if (!$scope.limitToItemId) return logs;
            else return _.filter(logs, {'_id': $scope.limitToItemId});
        };

        if ($scope.reservation && $scope.reservation.log){
            $scope.logs = limitIfNecessary($scope.reservation.log);
        } else if ($scope.reservationId || $scope.reservation._id) {
            Reservations.get({reservationId: $scope.reservationId || $scope.reservation._id, fields: 'log'}, function(reservation){
                $scope.logs = limitIfNecessary(reservation.log);
            });
        }
    }
]);
