'use strict';

//Reservations service used to communicate Reservations REST endpoints
angular.module('reservations').factory('ReservationsMetaInformation', ['$resource',
    function() {
        return {
            get: function(reservation) {
                var data = {};

                // Set reservation times with time zone
                data.withTimezone = {
                    checkInTime: reservation.plannedArrival || moment(reservation.checkIn).tz(reservation.listing.timezone).format('HH:mm'),
                    checkOutTime: reservation.plannedDeparture || moment(reservation.checkOut).tz(reservation.listing.timezone).format('HH:mm')
                };

                // creating a date object that holds the localized time (the actual date is not relevant)
                // need this object for the inline-time-editing directive, that should get a date-object
                data.withTimezone.checkIn = moment('10-10-10 ' + data.withTimezone.checkInTime).toDate();
                data.withTimezone.checkOut = moment('10-10-10 ' + data.withTimezone.checkOutTime).toDate();
                return data;
            }
        };
    }
]);
