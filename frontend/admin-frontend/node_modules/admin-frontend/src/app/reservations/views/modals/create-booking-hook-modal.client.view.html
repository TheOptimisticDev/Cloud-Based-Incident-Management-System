<section ng-init="ctrl.init()">
    <div class="modal-header"><h3>Create Hook For Reservation #<span data-ng-bind="reservation.confirmationCode"></span>
    </h3></div>
    <div class="modal-body">
        <div>
            <div>
                <h4>When</h4>
                <div class="input-group">
                    <label class="input-group-addon" for="select_events">Event</label>
                    <select data-ng-model="ctrl.hookData.event" class="form-control"
                            data-ng-options="e as e.displayName for e in ctrl.events" id="select_events"
                            required="required"></select>
                </div>
                <div class="form-inline top-buffer">
                    <div class="form-group radio">
                        <input type="radio" data-ng-model="ctrl.hookData.when" value="0" id="radio_when_0">
                        <label for="radio_when_0">At the event</label>
                    </div>
                    <div class="form-group radio">
                        <input type="radio" data-ng-model="ctrl.hookData.when" value="1" id="radio_when_1">
                        <label for="radio_when_1">After the event</label>
                    </div>
                    <div class="form-group radio" data-ng-if="ctrl.hookData.event.canScheduleHookBeforeEvent">
                        <input type="radio" data-ng-model="ctrl.hookData.when" value="-1" id="radio_when_-1">
                        <label for="radio_when_-1">Before the event</label>
                    </div>
                </div>
                <div data-ng-hide="ctrl.hookData.when == 0" class="form-inline top-buffer">
                    <input type="number" class="form-control" data-ng-model="ctrl.hookData.whenAmount" min="0"
                           max="1000">
                    <select class="form-control" data-ng-model="ctrl.hookData.whenType">
                        <option>Days</option>
                        <option>Hours</option>
                    </select>
                </div>
            </div>
            <div class="top-buffer">
                <h4>What</h4>
                <div class="input-group">
                    <label for="select_actions" class="input-group-addon">Action</label>
                    <select class="form-control" data-ng-model="ctrl.hookData.action"
                            data-ng-options="a as a.displayName for a in ctrl.actions" id="select_actions"
                            required="required"></select>
                </div>
            </div>
            <div class="top-buffer">
                <h4>Options</h4>
                <div>
                    <div class="input-group" data-ng-if="ctrl.hookData.action.target">
                        <label class="input-group-addon">To</label>
                        <select class="form-control" data-ng-model="ctrl.hookData.target"
                                data-ng-options="t as ctrl.targets[t] for t in ctrl.hookData.action.target"
                                id="select_targets" required="required"></select>
                    </div>
                </div>
                <div class="top-buffer">
                    <div class="input-group" data-ng-if="'contact|user'.indexOf(ctrl.hookData.target.toLowerCase()) > -1">
                        <label class="input-group-addon">Contact:</label>
                        <select class="form-control" data-ng-model="ctrl.hookData.contact"
                                data-ng-options="c as c.fullName for c in ctrl.contacts.results"></select>
                    </div>
                </div>
                <div class="top-buffer">
                    <div class="input-group" data-ng-if="ctrl.hookData.action.subjectNeeded">
                        <label class="input-group-addon">Subject:</label>
                        <input class="form-control" data-ng-model="ctrl.hookData.subject">
                    </div>
                </div>
                <div class="top-buffer">
                    <div class="input-group">
                        <label class="input-group-addon">Message</label>
                        <ng-switch on="ctrl.hookData.action.message">
                            <textarea data-ng-switch-when="plain" spellcheck="true"
                                      data-ng-model="ctrl.hookData.message" class="form-control" rows="5"></textarea>
                            <textarea data-ng-switch-when="html" spellcheck="true" data-ng-model="ctrl.hookData.message"
                                      rows="5" class="form-control ck-editor"></textarea>
                        </ng-switch>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer text-right">
            <button class="btn btn-success" data-ng-click="ctrl.save()">Save</button>
            <button class="btn btn-default" data-ng-click="ctrl.cancel()">Cancel</button>
        </div>
    </div>
</section>
