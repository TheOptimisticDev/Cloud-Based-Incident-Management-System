<section data-ng-controller="EmployeeController as employeeCtrl" data-ng-init="employeeCtrl.init()">
    <form name="frmEmployee" data-ng-submit="employeeCtrl.save(frmEmployee)">
        <div class="page-header">
            <div class="pull-right" data-ng-show="frmEmployee.$dirty">
                <small class="text-warning">Changes were made</small>
                <small class="text-danger" data-ng-show="frmEmployee.$invalid">Form has errors.</small>
                <button class="btn btn-save" type="submit" data-ng-disabled="frmEmployee.$invalid"><i class="fa fa-save"></i> Save</button>
            </div>
            <h1 data-ng-bind="employeeCtrl.employee._id ? employeeCtrl.employee.username : 'New user'"></h1>
        </div>
        <div class="page-body" data-ng-show="employeeCtrl.employee.$resolved">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">User</h3>
                </div>
                <div class="panel-body">
                    <div class="form-group">
                        <label>Username</label>
                        <input type="text" class="form-control" data-ng-model="employeeCtrl.employee.username" data-ng-disabled="employeeCtrl.employee._id">
                    </div>
                    <div class="form-group">
                        <label>Presentable name</label>
                        <input type="text" class="form-control" data-ng-model="employeeCtrl.employee.presentableName" required placeholder="Will be used as receptionist's signature">
                    </div>
                    <div class="form-group" data-ng-if="!employeeCtrl.employee._id">
                        <label>Password</label>
                        <input type="text" class="form-control" data-ng-model="employeeCtrl.employee.password" disabled required>
                    </div>
                    <div class="form-group">
                        <label>Roles</label>
                        <div data-ng-repeat="role in employeeCtrl.availableRoles">
                            <label>
                                <input type="checkbox" data-ng-checked="employeeCtrl.employee.roles.indexOf(role)>-1" data-ng-click="employeeCtrl.toggleRole(role, frmEmployee)">
                                <span data-ng-bind="role"></span>
                            </label>
                        </div>
                    </div>
                    <hr>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" data-ng-model="employeeCtrl.employee.fulltime">
                            Full time
                        </label>
                    </div>
                    <hr>
                    <div class="form-group">
                        <strong>Preferences:</strong>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" data-ng-model="employeeCtrl.employee.preferences.hideTicketCounter">
                            Hide ticket counter
                        </label>
                    </div>
                </div>
            </div>


            <div class="panel panel-default" data-ng-if="employeeCtrl.employee.isInShift">
                <div class="panel-heading">
                    <h3 class="panel-title">Current Shift</h3>
                </div>
                <div class="panel-body">
                    <div class="form-group">
                        <label>Started</label>
                        <span data-ng-bind="employeeCtrl.currentShift.checkIn|date"></span>
                        (<span data-am-time-ago="employeeCtrl.currentShift.checkIn"></span>)
                        <button class="btn btn-primary" data-ng-click="employeeCtrl.checkOut()">Check out</button>
                    </div>
                </div>
            </div>

            <div class="panel panel-default" data-ng-if="employeeCtrl.employee._id">
                <div class="panel-body">
                    <div class="form-group">
                        <button class="btn btn-danger" data-ng-if="employeeCtrl.employee.isActive" data-ng-click="employeeCtrl.deactivateUser(frmEmployee)">Deactivate user</button>
                        <button class="btn btn-success" data-ng-if="!employeeCtrl.employee.isActive" data-ng-click="employeeCtrl.reactivateUser(frmEmployee)">Reactivate user</button>
                    </div>
                </div>
            </div>
        </div>
    </form>
</section>
