/* global _, moment */
'use strict';

// Shift List controller
angular.module('admin').controller('EmployeesListController', [
    '$scope',
    'Employees',
    function($scope, Employees) {

        var self = this;

        self.limit = 25;

        self.availableRoles = [
            'admin',
            'receptionist',
            'receptionists-reviewer',
            'shift-manager',
            'shifts-viewer',
            'system-manager',
            'sales',
            'post-booking',
					  'account-manager'
        ];

        self.loadList = function(){
            var q = {
                fields: 'isActive username presentableName roles isInShift isInInbox created',
                limit: self.limit,
                skip: (self.page-1) * self.limit
            };

            if (self.filteredActive !== null){
                q.active = self.filteredActive;
            }
            if (self.filteredRole !== null){
                q.role = self.filteredRole;
            }

            self.employees = Employees.query(q, function(){
                self.counter = self.employees.count;
            });
        };



        self.filterByActive = function(state){
            self.filteredActive = state;
            self.loadList();
        };

        self.filterByRole = function(role){
            self.filteredRole = role;
            self.loadList();
        };

        self.init = function(){
            self.filteredRole = null;
            self.filteredActive = true;
            self.page = 1;

            self.loadList();
        };


    }
]);
