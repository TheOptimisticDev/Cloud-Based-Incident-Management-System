'use strict';

angular.module('integrations').controller('IntegrationController', [
    '$scope',
    '$stateParams',
    'Integrations',
    'notify',
    function($scope, $stateParams, Integrations, notify) {

        var self = this;

        self.init = function(){
            $scope.integration = Integrations.get({integrationId: $stateParams.integrationId});
        };

        // Save
        $scope.saveIntegration = function(integration, frm){
            integration.$save(function(){
                notify({message:'Integration was saved!', classes: 'alert-success'});
                if (frm) frm.$setPristine();
            }, function(response){
                var extraMessage = response.data ? response.data.message : '';
                notify({message:'Saving failed: ' + response.status + ': ' + response.statusText + ': ' + extraMessage, classes: 'alert-danger'});
            });
        };

        self.init();

    }
]);
