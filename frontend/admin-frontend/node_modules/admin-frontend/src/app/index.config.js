(function(){
	'use strict';

	/** @ngInject **/
	function config($logProvider, $locationProvider, jwtInterceptorProvider, $httpProvider, AppConfig){
		// Enable log
		$logProvider.debugEnabled(AppConfig && AppConfig.DEBUG);

		// Html5mode (remove .html from urls)
		$locationProvider.html5Mode(true).hashPrefix('!');

		var baseApi2Url = AppConfig.API_URL;
		var baseApiOldUrl = AppConfig.API_OLD_URL;

		jwtInterceptorProvider.tokenGetter = ['Authentication', 'config', function(Authentication, config){
			if(config.url.indexOf(baseApi2Url) === -1 && config.url.indexOf(baseApiOldUrl) === -1){
				return null;
			}
			return Authentication.getToken();
		}];

		$httpProvider.interceptors.push('jwtInterceptor');

		// Initialize the Firebase SDK
		var firebaseConfig = {
			apiKey: 'UcBhKQDPHSsJAgN2jwSdnwCWgDm2U9y2jR5lLChE',
			authDomain: 'guestyadmin.firebaseapp.com',
			databaseURL: 'https://guestyadmin.firebaseio.com/'
		};
		firebase.initializeApp(firebaseConfig);
	}

	angular.module('guestyAdmin').constant('AppConfig', _.extend(window.__envG, window.__appG));

	angular.module('guestyAdmin').constant('Enums', _.extend({}, window['guesty-shared'].enums));

	angular.module('guestyAdmin').constant('GuestyShared', _.extend({}, window['guesty-shared']));

	angular.module('guestyAdmin').config(config);
})();
