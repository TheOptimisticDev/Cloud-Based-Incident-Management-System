<section data-ng-controller="researchConversationsListController" data-ng-init="init(research.conversations, query, metadata)" class="research-list">
    <div data-ng-if="!isResearchNotIncludingListing">
        <h2>
            <span>Conversations about the same listing</span>
            <span class="label label-default pointer" data-ng-click="hideListingConversationsList = !hideListingConversationsList">Expand / Collapse</span>
        </h2>
        <div class="list" data-ng-hide="hideListingConversationsList">
            <div data-ng-hide="forListing.length">Conversations didn't match this research.</div>
            <div data-ng-repeat="conversation in forListing track by conversation._id" class="top-buffer pointer research-row" data-ng-class="{'selected': conversation._id === selectedConversationId}" data-ng-click="openConversationThreadLog(conversation)">
                <h4>
                    <span>Conversation with</span> <span data-ng-bind="conversation.conversationTitle"></span>
                    <span class="label label-info label-last-update">Last Message sent at: <span data-ng-bind="conversation.lastUpdatedAt|date:'short'"></span></span>
                    <span data-ng-if="conversation.subject" class="label label-default label0subject">Subject: <span data-ng-bind-html="conversation.subject"></span></span>
                </h4>
                <div data-ng-repeat="sentence in conversation.queryFoundInThread track by $index">..<i data-ng-bind-html="sentence"></i>..</div>
            </div>
        </div>
    </div>
    <hr>
    <div>
        <h2 class="text-danger">
            <ng-switch on="isResearchNotIncludingListing">
                <span data-ng-switch-default>Conversations about different listings</span>
                <span data-ng-switch-when="1">Conversations</span>
            </ng-switch>
            <span class="label label-default pointer" data-ng-click="hideOtherListingsConversationsList = !hideOtherListingsConversationsList">Expand / Collapse</span>
        </h2>
        <div class="list" data-ng-hide="hideOtherListingsConversationsList">
            <div data-ng-hide="forOtherListings.length">Conversations didn't match this research.</div>
            <div data-ng-repeat="conversation in forOtherListings track by conversation._id" class="top-buffer pointer research-row" data-ng-class="{'selected': conversation._id === selectedConversationId}" data-ng-click="openConversationThreadLog(conversation)">
                <h4>
                    <span>Conversation with</span> <span data-ng-bind="conversation.conversationTitle"></span>
                <span>
                    <span class="label label-info label-last-update">Last Message sent at: <span data-ng-bind="conversation.lastUpdatedAt|date:'short'"></span></span>
                    <span data-ng-if="conversation.listingId" class="label label-info label-listing">Listing: <span data-ng-bind="listings[conversation.listingId].title"></span></span>
                    <span data-ng-if="conversation.subject" class="label label-default label-subject">Subject: <span data-ng-bind-html="conversation.subject"></span></span>
                </span>
                </h4>
                <div data-ng-repeat="sentence in conversation.queryFoundInThread track by $index">..<i data-ng-bind-html="sentence"></i>..</div>
            </div>
        </div>
    </div>
</section>
