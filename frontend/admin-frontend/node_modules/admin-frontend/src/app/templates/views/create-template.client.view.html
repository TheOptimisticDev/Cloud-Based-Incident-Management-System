<button data-ng-hide="addTemplateMode" data-ng-click="btnAddTemplateMode()" class="btn btn-success">Add Template</button>
<form data-ng-submit="create()" name="frmTemplate" data-ng-if="addTemplateMode">
    <section class="panel panel-default">
        <div class="panel-heading">
            <span>Add Template</span>
            <div class="btn-group pull-right">
                <button type="button" data-ng-click="changeTemplateType(template, 'plain')" class="btn btn-default btn-xs" data-ng-disabled="template.type === 'plain'"><strong>plain</strong> template</button>
                <button type="button" data-ng-click="changeTemplateType(template, 'email')" class="btn btn-default btn-xs" data-ng-disabled="template.type === 'email'"><strong>email</strong> template</button>
            </div>
        </div>

        <div class="panel-body">
            <div class="form-group">
                <label>Template name</label>
                <input type="text" name="name" placeholder="Enter template name" class="form-control" required data-ng-model="template.name">
            </div>
            <div data-ng-if="template.type === 'email'">
                <div class="form-group">
                    <label>Subject</label>
                    <input type="text" name="subject" placeholder="Enter subject" class="form-control" required data-ng-model="template.subject">
                </div>
                <div class="form-group">
                    <label>Attachments</label>
                    <div class="btn-group" uib-dropdown>
                        <button type="button" class="btn btn-default dropdown-toggle" uib-dropdown-toggle data-ng-if="accountFiles.length">
                            Account Files <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu" role="menu" uib-dropdown-menu>
                            <li data-ng-click="attachFileToTemplate(template, file)" data-ng-repeat="file in accountFiles"><a>{{file.filename}}</a></li>
                        </ul>
                        <button type="button" class="btn btn-default"  data-ng-click="uploadAndAttachFile(form)">New File</button>
                    </div>
                    <div name="attached_files" class="form-control" id="attached_files">
                        <span data-ng-repeat="attachment in template.attachments"><span class="label label-primary"> {{attachment.filename}} <i class="fa fa-times" data-ng-click="removeAttachedFile(template, attachment)"></i></span> </span>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label>Body</label>
                <textarea data-ng-if="template.type === 'plain'" spellcheck="true" class="form-control" data-g-autoresize data-ng-model="template.body" name="body"></textarea>
                <textarea data-ng-if="template.type === 'email'" spellcheck="true" class="form-control ck-editor" data-ng-model="template.body" name="body"></textarea>
            </div>
        </div>
        <div class="panel-footer text-right">
            <button type="submit" class="btn btn-success" data-ng-disabled="frmTemplate.$invalid">Save Template</button>
        </div>
    </section>
</form>