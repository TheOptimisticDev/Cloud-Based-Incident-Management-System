'use strict';

angular.module('core').factory('dataFallback', [
    '$stateParams',
    function($stateParams) {
        /**
         * check if an object or it's ID is available to use
         * @param scope - current scope
         * @param dataName - name of the requested object
         * @param callback - will get the objectId (if exists) and all the requested object (if exists)
         * @returns {Boolean} - if could find the requested object or its object-ID
         */
        function dataFallback(scope, dataName, callback) {
            // the key to the data-id, if it's on the scope
            var idKey = dataName + 'Id';
            // the key to the data-id, it it's on the data-object
            var dataIdKey = '_id';

            var content, contentId;

            if(scope[dataName] && scope[dataName][dataIdKey]) {
                contentId = scope[dataName][dataIdKey];
                content = scope[dataName];
            } else if(scope[idKey]) {
                contentId = scope[idKey];
            } else if($stateParams[idKey]) {
                contentId = $stateParams[idKey];
            }

            callback(contentId, content);
            return (contentId || content);
        }
        return dataFallback;
    }
]);
