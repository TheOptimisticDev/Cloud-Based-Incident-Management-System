 <div class="panel panel-default" ng-init="otp.init()">
    <div class="panel-heading">
        <h3 class="panel-title">One Time payments</h3>
    </div>
    <div class="panel-body">
        <div ng-if="otp.upcomingPayments.length">
            <h4>Upcoming payments</h4>
            <table class="table">
                <thead>
                <tr>
                    <th scope="col">NAME</th>
                    <th scope="col">BILLING DATE</th>
                    <th scope="col">TYPE</th>
                    <th scope="col">AMOUNT</th>
                    <th></th>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="invoice in otp.upcomingPayments">
                    <td>{{invoice.description}}</td>
                    <td>{{invoice.shouldBePaidAt | date : 'shortDate'}}</td>
                    <td>{{otp.billingTypes[invoice.oneTimePaymentType]}}</td>
                    <td>${{invoice.amount}}</td>
                    <th>
                        <button type="button" class="btn btn-danger" ng-click="otp.deleteInvoice(invoice)">
                            <i class="fa fa-trash"></i>
                        </button>
                    </th>
                </tr>
                </tbody>
            </table>
        </div>
        <p ng-if="otp.pastPayments.length">
            <a ng-if="!otp.history" ng-click="otp.history = true">Show history</a>
            <a ng-if="otp.history" ng-click="otp.history = false">Hide history</a>
        </p>
        <div ng-if="otp.pastPayments.length && otp.history">
            <h4>Payment history</h4>
            <table class="table">
                <thead>
                <tr>
                    <th scope="col">NAME</th>
                    <th scope="col">BILLING DATE</th>
                    <th scope="col">TYPE</th>
                    <th scope="col">AMOUNT</th>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="invoice in otp.pastPayments">
                    <td>{{invoice.description}}</td>
                    <td>{{invoice.shouldBePaidAt | date : 'shortDate'}}</td>
                    <td>{{otp.billingTypes[invoice.oneTimePaymentType]}}</td>
                    <td>${{invoice.amount}}</td>
                </tr>
                </tbody>
            </table>
        </div>

        <div class="row">
            <form name="otp.frm" ng-if="otp.showForm">
                <div class="form-group col-md-2">
                    <input ng-model="otp.invoiceItem.description"
                           name="itemName"
                           type="text" class="form-control"
                           placeholder="Item Name"
                           required>
                    <span class="help-block text-danger" ng-show="otp.frm.itemName.$error.required && otp.frm.itemName.$dirty">Please enter an item name</span>
                </div>
                <div class="form-group col-md-2">
                    <div class="input-group">
                        <div class="input-group-addon">$</div>
                        <input ng-model="otp.invoiceItem.amount"
                               name="amount"
                               min="1"
                               type="number" class="form-control"
                               placeholder="Amount"
                               required>
                    </div>
                    <span class="help-block text-danger" ng-show="(otp.frm.amount.$error.required || otp.frm.amount.$error.min)  && otp.frm.amount.$dirty">Please enter a positive number without any commas</span>
                </div>
                <div class="form-group col-md-3">
                    <select class="form-control"
                            ng-model="otp.chargeTime">
                        <option ng-repeat="option in otp.chargingTimeOptions"
                                ng-selected="option.selectedByDefault == true"
                                value="{{option.val}}"
                                ng-disabled="option.disabled">
                            {{option.label}}
                        </option>
                    </select>
                </div>
                <div ng-if="otp.chargeTime === otp.billingTypeEnum.ON_FUTURE_BILLING_CYCLE" class="form-group col-md-2">
                    <input ng-model="otp.invoiceItem.shouldBePaidAt"
                           min="{{otp.endOfDay | date:'yyyy-MM-dd'}}"
                           class="form-control"
                           type="date"
                           ng-required="otp.chargeTime === otp.billingTypeEnum.ON_FUTURE_BILLING_CYCLE">
                </div>
                <div class="form-group col-md-3">
                    <button ng-click="otp.submit(otp.frm)"
                            ng-disabled="!otp.frm.$valid"
                            type="button"
                            class="btn btn-primary">Confirm
                    </button>
                    <button ng-click="otp.resetForm(otp.frm)" type="button" class="btn btn-default">Cancel</button>
                </div>
            </form>
        </div>
        <div class="row">
            <div class="col-md-12">
                <button ng-click="otp.showForm = true" type="button" class="btn btn-primary">Add One Time Payment</button>
            </div>
        </div>
    </div>
</div>