'use strict';

//Listings service used to communicate Listings REST endpoints
angular.module('listings').factory('ListingsModalsService', ['$uibModal',
    function($uibModal) {
        return {
            /**
             * modal to set availability status and price for certain dates
             * @param listingId
             * @param [listing]
             * @param [formData] {{startDate, endDate, availability, price}}
             * @returns {deferred.promise}
             */
            openListingCalendarAvailabilityModal: function(listingId, listing, formData) {
                return $uibModal.open({
                    windowClass: 'listing-calendar-availability-modal modal-padded',
                    templateUrl: 'app/listings/views/modals/listing-calendar-availability-modal.client.view.html',
                    controller:  'ListingCalendarAvailabilityModalController',
                    resolve: {
                        listingId: function() {
                            return listingId;
                        },
                        listing: function() {
                            return listing;
                        },
                        formData: function() {
                            return _.clone(formData || {});
                        }
                    }
                }).result;
            },

            openListingGalleryModal: function(listingId) {
                return $uibModal.open({
                    windowClass: 'listing-gallery-modal modal-padded',
                    templateUrl: 'app/listings/views/modals/gallery-modal.client.view.html',
                    controller:  'ListingGalleryModalController as ctrl',
                    size: 'lg',
                    resolve: {
                        listingId: function() {
                            return listingId;
                        }
                    }
                }).result;
            }
        };
    }
]);
