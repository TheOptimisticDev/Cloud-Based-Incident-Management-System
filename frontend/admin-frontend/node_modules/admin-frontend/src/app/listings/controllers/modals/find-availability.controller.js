'use strict';

angular.module('accounts').controller('FindAvailabilityCtrl', [
    'ListingCalendar',
    '$uibModalInstance',
    'initialValues',
    function(ListingCalendar, $uibModalInstance, initialValues) {

        var self = this;

        self.now = new Date();
        self.occupancyArray = _.range(1, 16);

        self.init = function(){
            if (initialValues){
                self.checkIn = moment(initialValues.checkIn).toDate();
                self.checkOut = moment(initialValues.checkOut).toDate();
                self.minOccupancy = initialValues.minOccupancy;
                self.initialValues = true;
            } else {
                self.checkIn = new Date();
                self.checkOut = moment().add(1, 'day').toDate();
                self.minOccupancy = 1;
            }
        };

        self.updateField = function(field, value, frm){
            _.set(self, field, value);
            frm.$setDirty();
        };

        self.submit = function(){
            $uibModalInstance.close({
                checkIn: self.checkIn,
                checkOut: self.checkOut,
                minOccupancy: self.minOccupancy
            });
        };

    }
]);
