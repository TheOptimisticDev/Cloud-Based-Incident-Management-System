'use strict';

/**
 * this controller can be opened from $uibModal only. please don't forget to send 'formData' to the modal.
 * data that should be sent at formData: {customer}
 */
angular.module('accounts').controller('LogModalController', ['$scope', '$uibModalInstance', 'formData', 'Accounts',
    function($scope, $uibModalInstance, formData, Accounts) {
        $scope.limit = 10;
        $scope.currentPage = 1;

        $scope.find = function() {
            Accounts.logs({
                accountId: formData.account ? formData.account._id : null,
                categories: [formData.category],
                listingFilterEnabled: !!formData.listing,
                listingId: formData.listing ? formData.listing._id : null,
                skip: ($scope.currentPage - 1) * $scope.limit,
                limit: $scope.limit
            }, function(result) {
                $scope.logs = result.logs;
                $scope.totalCount = result.totalCount;
            });
        };
    }
]);
