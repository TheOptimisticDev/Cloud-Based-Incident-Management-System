'use strict';

(function(){
	var employeeSelector = {
		bindings: {
			selected: '<',
			onChange: '&',
			limitRole: '@?',
		},
		templateUrl: 'app/employees/components/employee-selector.html',
		controller: controller,
		controllerAs: 'ctrl',
	};

	/* @ngInject */
	function controller(Employees){
		var self = this;
		self.employees = [];
		self.loadResults = loadResults;

		function loadResults(q){
			return Employees.query({
				fields: 'username presentableName',
				q: q,
				role: self.limitRole
			}, function(response){
				self.employees = response.results || [];
			});
		}
	}

	angular.module('employees').component('employeeSelector', employeeSelector);
})();
